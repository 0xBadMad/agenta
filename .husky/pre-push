# Check frontend changes
if git diff --name-only --cached origin/$(git rev-parse --abbrev-ref HEAD) | grep -q '^agenta-web/'; then
    cd agenta-web || exit

    # Run ESLint check
    if ! npm run lint; then
         echo '❌ ESLint issues detected. Please fix them before pushing the code.'
        exit 1
    fi

    # Run TypeScript type check
    if ! npm run types:check; then
        echo '❌ Frontend type check failed.'
        exit 1
    fi

    echo '🎉 All checks passed. Ready to push!'
fi

# Check backend changes
if git diff --name-only --cached origin/$(git rev-parse --abbrev-ref HEAD) | grep -q '^agenta-backend/'; then
    cd agenta-backend || exit

    # Run backend checks
    if ! pylint --recursive=y --errors-only .; then
        echo '❌ pylint issues detected. Please fix them before pushing the code.'
        exit 1
    fi

    echo '🎉 Backend checks passed. Ready to push!'
fi

# Check cli changes
if git diff --name-only --cached origin/$(git rev-parse --abbrev-ref HEAD) | grep -q '^agenta-cli/'; then
    cd agenta-cli || exit

    # Run backend checks
    if ! pylint --recursive=y --errors-only .; then
        echo '❌ pylint issues detected. Please fix them before pushing the code.'
        exit 1
    fi

    echo '🎉 Backend checks passed. Ready to push!'
fi