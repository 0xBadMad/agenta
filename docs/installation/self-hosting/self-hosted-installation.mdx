---
title: Self hosting on AWS or GCP
description: 'Installing Agenta on AWS or GCP'
---

## General Prerequisities
To get started;

1. **Install Terraform**: First, install [Terraform](https://developer.hashicorp.com/terraform/tutorials/aws-get-started/install-cli).

## AWS
We provide a Terraform module to deploy Agenta on AWS. You can find it [here](https://github.com/Agenta-AI/agenta/tree/main/self-host/aws).
The terraform module will simply create a t2.medium instance, a security group (with the open ports: 80, 8080), an elastic IP and an ebs volume all of them in eu-central-1.
You can customize the module according to your needs.

1. **Configure AWS Credentials**: Follow the instructions [here](https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-configure.html) to set up your AWS credentials.
2. **Initialize and Apply Terraform**: Navigate to the correct directory and run:
   ```bash
   cd self-host/aws
   terraform init
   terraform apply
   ```

Terraform will prompt you for a specific domain. You can specify a domain or leave it blank.

Once Terraform finishes creating the resources, it will display the domain name or IP where Agenta can be accessed. Here's a sample output:
```
Open the link below in your browser to access Agenta, but wait a few minutes for the services to start.

Important: If you provided a domain name, ensure that it points to this IP address: x.x.x.x

Link: http://demo.agenta.ai
```

Ensure that the domain name points to the IP address given by Terraform if you provided one.

Please note, Agenta might take a few minutes to become accessible as it installs dependencies and initializes. Refer to this script for more details: [instance-setup.sh](https://github.com/Agenta-AI/agenta/blob/main/self-host/aws/instance-setup.sh)

<Warning>There is no security mechanism in place yet. Exercise caution.</Warning>

#### Serving a Variant to an Instance
After hosting Agenta on an instance, you can serve a variant by running:

```bash
agenta init
? Please enter the app name job_classifier
? Are you running agenta locally? No
? Please provide the IP or URL of your remote host demo.agenta.ai
? How do you want to initialize your app? Blank App
App initialized successfully
```
<Warning>Provide the remote host without the protocol (http://)</Warning>

#### SSH into the instance:
In order to ssh into the instance you need to:

1. Uncomment these lines in the [security group](https://github.com/Agenta-AI/agenta/blob/main/self-host/aws/agenta_instance_sg.tf)
```bash
ingress {
  description = "SSH"
  from_port   = 22
  to_port     = 22
  protocol    = "tcp"
  cidr_blocks = ["0.0.0.0/0"]
}
```

and also these line in the [instance](https://github.com/Agenta-AI/agenta/blob/main/self-host/aws/agenta_instance.tf) file:

```bash
resource "aws_key_pair" "agenta_key" {
  key_name   = "agenta-key"
  public_key = file("~/.ssh/id_rsa_agenta.pub")
}


key_name      = aws_key_pair.agenta_key.key_name
```

2. Create a key pair in the AWS console or via:
   ```bash
   ssh-keygen -t rsa -b 4096 -f ~/.ssh/id_rsa_agenta
   ```

3. Connect using:
   ```bash
   ssh -i ~/.ssh/id_rsa_agenta ubuntu@ec2-host-provided-by-aws
   ```

## GCP 
We provide a Terraform module to deploy Agenta on GCP. You can find it [here](https://github.com/Agenta-AI/agenta/tree/main/self-host/gcp).
The terraform module will in the in us-central1 region create;
   - An e2-medium Compute instance
   - VPC Network
   - Firewall configured to allow ports 22 (ssh), 80 (http), and 443 (https)
   
You can customize the module according to your needs.

### Prerequisites

1. **Setup Project**; In the [Google cloud Console](https://console.cloud.google.com), on the project selector page, select or [create a Google Cloud project](https://cloud.google.com/resource-manager/docs/creating-managing-projects), then copy and save the Project ID for later.
2. **Confirm Billing**; [Make sure that billing is enabled for your Google Cloud project.](https://cloud.google.com/billing/docs/how-to/verify-billing-enabled#console)
3. **Create a Service account**; Click [here to Create a Service account](https://cloud.google.com/iam/docs/service-accounts-create) and specify the compute admin role.

   <img height="600" src="/images/agenta_service_account.png" />

4. **Get Service account key**; Click [here to obtain the keys for the service account](https://console.cloud.google.com/iam-admin/serviceaccounts?walkthrough_id=iam--create-service-account-keys&start_index=1#step_index=1) you created.
5. Copy the content of the downloaded key file and replace the content of [credentials.json][https://github.com/Agenta-AI/agenta/blob/main/self-host/gcp/credentials.json] with it.
6. Enable Google Compute Engine API: Navigate to [Compute Engine API](https://console.cloud.google.com/apis/library/compute.googleapis.com) and make sure to select the correct project at the top, then enable Compute Engine API.
7. **Initialize and Apply Terraform**: Navigate to the correct directory and run:
   ```bash
   cd self-host/gcp
   terraform init
   terraform apply

#### SSH into the instance:
In order to ssh into the instance you need to:

1. Uncomment these lines in the [Terraform instance file](https://github.com/Agenta-AI/agenta/blob/main/self-host/gcp/agenta_instance.tf)
```bash
metadata = {
 ssh-keys = "YOUR_USERNAME:${file("~/.ssh/id_rsa.pub")}"
}
```

2. [Create an SSH key pair.](https://cloud.google.com/compute/docs/connect/create-ssh-keys)

3. [Add the SSH Key to the VM Metadata](https://cloud.google.com/compute/docs/connect/add-ssh-keys)

4. Rerun 
   ```bash
   terraform apply.
   ```

Remember that while allowing SSH access from any source (0.0.0.0/0) is convenient for testing, it's not recommended for production environments due to security concerns. In production, you would restrict SSH access to specific trusted IP addresses.

#### Removing All Resources:
To delete all the resources created by Terraform, simply run

For GCP:

```bash
cd self-host/gcp
terraform destroy
```

For AWS:

```bash
cd self-host/aws
terraform destroy
```